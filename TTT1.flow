blockdiag {
    rows -> perm ->  wt1 -> wt2 -> req;

    rows [type=start, initial="[{1:'1',2:'2',3:'3'}, {1:'4',2:'5',3:'6'}, {1:'7',2:'8',3:'9'}]"];
    wt1 [type=sync, wait="['X'+t[1]]"]
    wt2 [type=sync, wait="['X'+t[2]]"]
    req [type=sync, req="['O'+t[3]]"]
    perm [type=permutation, keys="[1,2,3]"]

    x -> rq;
    x [type=start, initial="[{'e':'X1'}, {'e':'X2'}, {'e':'X3'}, {'e':'X4'}, {'e':'X5'}, {'e':'X6'}, {'e':'X7'}, {'e':'X8'}, {'e':'X9'} ]"]
    rq [type=sync, req="[t['e']]"]


    # For debugging
    class hidden [color = none, style = none, textcolor = white];
    stt -> listener -> logger [style = "none"];
    listener -> listener [style = "none"];
    listener [type=sync, wait="lambda e : True", class = "hidden", autoformat='false'];
    logger [type=logger, label="Events log", autoformat='false']
    stt [type=start, class = "hidden", autoformat='false'];

}
